<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ja">
<head>
<meta charset="utf-8" />
<title>Unofficial MCP support plugin for Eclipse</title>
<meta name="description"
	content="Eclipseを使ったMCPによるMOD開発をサポートするプラグインの説明書" />
<meta http-equiv="Content-Script-type" content="text/javascript" />
<meta http-equiv="Content-Style-type" content="text/css" />
<link rel="stylesheet" href="site/css/site.css" type="text/css"
	media="all" />
</head>
<body>
	<div th:fragment="name" th:remove="tag">使い方</div>
	<div th:fragment="article">
		<article>
			<pre>
以下の説明では、各項目や操作をPleiades All in One Eclipse 4.2環境における名称で記述しています。
それ以外の環境でも使用出来ます(たぶん)が、英語だったり名称が違う可能性がありますので、頑張って読み替えて下さい。

１，プロジェクトの分割
プロジェクトを分割しなくても、ソースフォルダーを複数作成したり、ソースのリンクによって「Minecraftのソース」「前提MODのソース」「自MODのソース」
と分かれていれば、問題なく設定することができますが、後から構成の変更がしやすい、プロジェクト自体を分割する方法で説明していきます。

１．１，前準備
これからMODを作成する人は３に進んで下さい。
分割したいMODの前提MODがある場合は、まずそちらの分割作業から始めます。

２，ソースの準備
既に本体と自作MODのソースが混在している場合は、頑張って自作MODのソースを分けて下さい。
既存書き換えをしている場合、差分元として書き換え前のソースをMinecraftのソースフォルダーに置く必要があります。

３，プロジェクトの作成
任意の名前でJavaプロジェクトを新規に作成します。
特に設定を弄る必要はありません。

４，ソースの配置
作成したプロジェクトのソースフォルダーに自作MODのソースを配置します。
パッケージ構成も含めて、同じ構造にします。

５，ビルドパスの設定
５．１，本体プロジェクトの設定
Minecraft本体プロジェクトのプロパティーを開き、「Javaのビルドパス」を選びます。
「順序及びエクスポート」タブを選び、「全て選択」ボタンで項目すべてにチェックをつけて「OK」で画面を閉じます。

５．２，自作MODプロジェクトの設定
自作MODプロジェクトのプロパティーを開き、「Javaのビルドパス」を選びます。
「プロジェクトタブ」を選び、「追加」ボタンで、Minecraft本体プロジェクトを追加します。

(オプション)：自作MODプロジェクトが必要とする前提MODプロジェクトがあれば、それらも追加します。

「ライブラリー」タブを選び、JREや他の項目をすべて「除去」して、「OK」で画面を閉じます。


CHECK：
この時点で、正しく設定できていればビルドエラーは起こりません。

５．３，自作MODデバッグ、実行の構成
ソースが切り離されるため、startclient.batでは起動できなくなりますので、Eclipseから(デバッグ)起動が出来るようにします。
(ビルド用仮想MCPロケーションであれば、ソースが全てコピーされているためstartclient.batでも起動出来ます)
自作MODプロジェクトを選択し、メニューバーから「実行」->「実行構成」を選び、実行の構成ダイアログを開きます。

５．３．１，構成の作成
「Javaアプリケーション」を選択し、「新規」ボタンで構成を新規作成します。


５．３．２，メイン設定
「メイン」タブを選び、「プロジェクト」に自作MODプロジェクト名を入力、「メイン・クラス」に「Start」と入力します。

５．３．３，引数の設定
「引数」タブを選び、「VM引数」に「-Xincgc -Xmx1024M -Xms1024M」を入力、
「作業ディレクトリー」の項目で「その他」を選び、「${workspace_loc:Minecraft/jars}」を入力します。

５．３．４，JREの設定
「JRE」タブを選び、実行環境として適切な(これは各人の環境によるので調べて下さい)実行環境を設定します。

５．３．５，実行
「適用」ボタンで設定を保存した後、「実行」あるいは「デバッグ」ボタンで、マインクラフトが自作MOD入りで起動することを確認します。

６，MCPプラグインの設定
自作MODプロジェクトのプロパティーを開き、「MCPビルド」を選びます。

６．１，「MCPロケーション」タブの設定
「MCPロケーション」タブを選びます。

６．１．１，MCPロケーションの設定
設定をいじっていなければデフォルトの「MCP_LOC」でMCPディレクトリのファイルパスが表示されますが、
構成が異なる場合は「フォルダを参照」ボタンや直接入力でMCPディレクトリのファイルパスを指定して下さい。

６．１．２，ビルド用仮想MCPロケーションの設定
Unofficial MCP support plugin for Eclipse では、MCPの各種操作にあたって、
MCPのコマンド一式やランタイムをコピーした作業用ディレクトリを作成します。(srcフォルダーを削除したりするためです)
デフォルトのままで問題ありませんが、必要な場合は任意のファイルパスに変更して下さい。

６．１．３，出力Zipファイル名の設定
Zip圧縮操作を行った際に出力されるファイル名を指定します。
デフォルトではmod_(プロジェクト名).zipとなります。
ファイルはプロジェクト・ディレクトリーの直下に生成され、同名ファイルがあった場合は(ファイル名)_(連番).zipにリネームします。

※パスについて
「MCPロケーション」タブで設定する２つのロケーションタブは、Eclipseのリソース変数、ワークスペース変数を解釈します。
また、リソース変数については自身のプロジェクトのリソース変数に加え、
「プロジェクト参照」か「ビルドパス」で「直接参照している」プロジェクトのリソース変数も解釈します。
(なので、MCPが用意したMinecraftプロジェクトをビルドパスの参照プロジェクトに加える事で、{MCP_LOC}を個別に設定しなくても解釈出来ます)

６．２，「依存ソースロケーション」タブの設定
updatemd5を行なって「差分元」を作る際の差分元となるソースフォルダーを選択します。
具体的には、ビルド用仮想MCPロケーションのsrcフォルダーに、このタブで選択されたソースフォルダーのソースを全てコピーし、
その状態でupdatemd5を行います。
基本的にはMincraft本体のソースフォルダーの選択が必須になります。
もし自作MODが前提MODを必要とする場合、このタブで前提MODのソースフォルダーを選択することで、「Minecraft本体+前提MODソースを含む差分元」を生成できます。

６．３，「対象ソースロケーション」タブの設定
自作MODのソース・フォルダーを選択します。
具体的には、ビルド用仮想MCPロケーションのsrcフォルダーに、「依存ソースロケーション」に加えてこのタブで選択されたソースを全てコピーし、
その状態でreobfucateを行います。
結果、事前に「依存ソースロケーション」のソースのみでupdatemd5を行なっていれば、このタブで選択されたソースが差分として出力されます。
(この一連の作業を一括で行うコマンドもあります)

６．４，「リソースロケーション」タブの設定
自作MODに含めるリソースを選択します。
選択されたリソースパスをZipファイル上にその構造のまま含めます。
つまり、「ファイル選択」で選択されたファイルはZipファイルの直下に配置され、
「フォルダ選択」で選択されたフォルダは、そのフォルダをルートとして同じ構造がZipファイル内に含まれることになります。


７，各種コマンド
設定に従ってMCPの各操作とZip圧縮を行います。
コマンドを実行したいプロジェクトを選択し、右クリックでコンテキストメニューを開き「MCPビルド」メニューを開きます。
各コマンドは、それぞれ以下の操作を記載の順に連続して実行します。

７．１，MD5更新
ビルド用仮想MCPロケーションのsrcフォルダーに、「依存ソースロケーション」タブで選択されたソースを全てコピーし、その状態でreobfucateを行います。

７．２，難読化
ビルド用仮想MCPロケーションのsrcフォルダーに、「依存ソースロケーション」、「対象ソースロケーション」タブで選択されたソースを全てコピーし、
recompileとreobfucateを行います。
正しい差分を出力するためには、事前に適切な「依存ソースロケーション」設定でMD5更新を実施する必要があります。

※MD5更新と難読化について
適切なソースフォルダーが選択されてさえいれば、MD5更新を行うのは同一プロジェクトでなくても構いません。
また、そのような同一構成の「依存ソースロケーション」設定を持ったMODを連続でビルドするような場合は、
MOD毎にMD5更新からやり直す必要はなく、難読化コマンドのみで差分が出力されます。

７．３，ZIP圧縮
ビルド用仮想MCPロケーションのreobfフォルダーに出力された難読化後のクラスファイルと、「リソースロケーション」で設定されたファイルを、
「ZIP圧縮出力ファイル名」で指定されたファイル名のZIPファイルとしてパッケージし、出力します。

			</pre>
		</article>
	</div>
</body>
</html>
